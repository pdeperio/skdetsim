************************************************************************
*     -------------------------------------
      SUBROUTINE SKTSIG_le(PE,SIG)
*     -------------------------------------
*
*     (Purpose)
*        TDC resolution 
*
*     (Input)
*        PE ; Photoelectrons
*
*     (Output)
*        SIG ; TDC resolution (nsec)       
*       
*     (Creation Date and Author)
*       1992.06.17 ; First version by K.S.Hirata
*       1996.06.19 ; modified for SK by E.Ichihara
*                           table: from S.Hatakeyama
*
************************************************************************

      implicit none

C ARG  
      REAL PE,SIG

C PARAMETER
      INTEGER   MAXT
      PARAMETER(MAXT=132)

C VAR    
      INTEGER I
      REAL    RATIO
      real PENUM(MAXT), TRES(MAXT)
c     <<<<<<< sktsig_le.F

      real p1(50),p2(50),p3(32)
      real t1(50),t2(50),t3(32)
 
      equivalence(PENUM(1),p1(1))
      equivalence(PENUM(51),p2(1))
      equivalence(PENUM(101),p3(1))
      
      equivalence(TRES(1),t1(1))
      equivalence(TRES(51),t2(1))
      equivalence(TRES(101),t3(1))

c     =======
      equivalence(PENUM(1),p1(1))
      equivalence(PENUM(51),p2(1))
      equivalence(PENUM(101),p3(1))
      equivalence(TRES(1),t1(1))
      equivalence(TRES(51),t2(1))
      equivalence(TRES(101),t3(1))

c     >>>>>>>1.4
      data p1 / 9.73236E-02, 0.194647, 0.291971, 0.389294, 0.486618,
     &     0.583942, 0.681265, 0.778589, 0.875912, 0.973236, 1.07056,
     &     1.16788, 1.26521, 1.36253, 1.45985, 1.55718, 1.65450, 1.75182,
     &     1.84915, 1.94647, 2.04380, 2.14112, 2.23844, 2.33577, 2.43309,
     &     2.53041, 2.62774, 2.72506, 2.82238, 2.91971, 3.01703, 3.11436,
     &     3.21168, 3.30900, 3.40633, 3.50365, 3.60097, 3.69830, 3.79562,
     &     3.89294, 3.99027, 4.08759, 4.18492, 4.28224, 4.37956, 4.47688,
     &     4.57421, 4.67153, 4.76886, 4.86618/
      data p2 / 5.09551, 5.33567, 5.58710, 5.85041, 6.12618, 6.41489,
     &     6.71718, 7.03377, 7.36525, 7.71236, 8.07586, 8.45645, 8.85499,
     &     9.27231, 9.70929, 10.16691, 10.6460, 11.1478, 11.6731, 12.2233,
     &     12.7994, 13.4026, 14.0342, 14.6956, 15.3882, 16.1134, 16.8728,
     &     17.6680, 18.5007, 19.3726, 20.2856, 21.2416, 22.2427, 23.2910,
     &     24.3887, 25.5381, 26.7416, 28.0019, 29.3216, 30.7035, 32.1506,
     &     33.6657, 35.2524, 36.9138, 38.6534, 40.4751, 42.3827, 44.3801,
     &     46.4717, 48.6618/
      data p3 / 50.9552, 53.3567, 55.8710, 58.5041, 61.2618, 64.1489,
     &     67.1718, 70.3377, 73.6526, 77.1236, 80.7586, 84.5645, 88.5499,
     &     92.7231, 97.0929, 101.6691, 106.460, 111.478, 116.731, 122.233,
     &     127.994, 134.026, 140.342, 146.956, 153.882, 161.134, 168.729,
     &     176.680, 185.007, 193.726, 202.856, 212.417/
c     <<<<<<<sktsig_le.F
     

c     =======
c     >>>>>>> 1.4
      data t1 / 4.03454, 3.81681, 3.68052, 3.47282, 3.35803, 3.23782,
     &     3.10297, 3.01302, 2.95695, 2.91753, 2.89976, 2.83168, 2.79245,
     &     2.73122, 2.68631, 2.64043, 2.60421, 2.57045, 2.49986, 2.45736,
     &     2.47258, 2.42681, 2.39932, 2.33524, 2.26287, 2.24498, 2.19616,
     &     2.06991, 2.01174, 1.96768, 1.93628, 1.89702, 1.84823, 1.82152,
     &     1.88167, 1.89045, 1.87777, 1.88767, 1.89997, 1.88880, 1.87388,
     &     1.87762, 1.85378, 1.84683, 1.83656, 1.82816, 1.87007, 1.88249,
     &     1.84841, 1.84264/
      data t2 / 1.82923, 1.79776, 1.76271, 1.68663, 1.65276, 1.60584,
     &     1.55678, 1.51851, 1.47033, 1.46008, 1.42863, 1.40158, 1.38076,
     &     1.38000, 1.34120, 1.34192, 1.31032, 1.31844, 1.28602, 1.28024,
     &     1.24825, 1.24160, 1.22380, 1.20542, 1.17453, 1.16385, 1.14533,
     &     1.13795, 1.11756, 1.08879, 1.06173, 1.04689, 1.02189, 0.991963,
     &     0.969860, 0.945783, 0.923613, 0.917236, 0.903717, 0.888961,
     &     0.882664, 0.864825, 0.858903, 0.862409, 0.842941, 0.827920,
     &     0.816413, 0.806203, 0.796448, 0.783163/
      data t3 / 0.763555, 0.758355, 0.746932, 0.737042, 0.724241, 0.710126,
     &     0.697234, 0.684782, 0.673681, 0.661196, 0.649570, 0.640959,
     &     0.633315, 0.626777, 0.621001, 0.614733, 0.610888, 0.606400,
     &     0.600678, 0.595106, 0.589510, 0.584052, 0.578758, 0.574185,
     &     0.573048, 0.573541, 0.573444, 0.576661, 0.577937, 0.577272,
     &     0.591900, 0.579268/
c     <<<<<<< sktsig_le.F
    
c     =======

c     >>>>>>> 1.4
      save PENUM,p1,p2,p3,TRES,t1,t2,t3

C program     

      IF(PE.LE.PENUM(1))THEN
         SIG = TRES(1)
      ELSE IF(PE.GE.PENUM(MAXT))THEN
         SIG = TRES(MAXT)
      ELSE
         I = 1
 10      CONTINUE
            I = I + 1
         IF(PE.GT.PENUM(I))GOTO 10
         RATIO = (PE-PENUM(I-1))/(PENUM(I)-PENUM(I-1))
         SIG = TRES(I-1)+RATIO*(TRES(I)-TRES(I-1))
      ENDIF

      RETURN
      END
