************************************************************
*     -------------------------
      FUNCTION acrnsg(wlen)
*     -------------------------
*
*     (Purpose)
*     Calculate refractive index of acrylic
*
*     (Input)
*     wlen   : wave length of the light (nm)
*
*     (Output)
*     real part of refractive index: 
*
*     (Comment)
*     When wavelength is more than 600(nm) or less than 295(nm),
*     Function acrnsg return 1.49 . 
*
*     (Creation Date and Author)
*       2002.11.7  ; R.Nambu
*************************************************************
      implicit none
c number of datas
      integer max
      parameter (max=306)
c input 
      real wlen
c output
      real acrnsg
c local variable
      real WL(max),REAL(max),diff,wlstart
      parameter (wlstart = 295.)
      real rea1(50),rea2(50),rea3(50),rea4(50),rea5(50),rea6(50),rea7(6)

      equivalence(REAL(1),rea1(1))
      equivalence(REAL(51),rea2(1))
      equivalence(REAL(101),rea3(1))
      equivalence(REAL(151),rea4(1))
      equivalence(REAL(201),rea5(1))
      equivalence(REAL(251),rea6(1))
      equivalence(REAL(301),rea7(1))

      data rea1/1.556947017,1.556723434,1.556499462,1.556275107,1.556050378,
     &     1.55582528,1.555599822,1.55537401,1.555147851,1.554921354,
     &     1.554694525,1.554467371,1.554239899,1.554012117,1.553784032,
     &     1.553555652,1.553326982,1.553098031,1.552868806,1.552639313,
     &     1.552409561,1.552179556,1.551949306,1.551718817,1.551488097,
     &     1.551257154,1.551025994,1.550794624,1.550563052,1.550331286,
     &     1.550099331,1.549867196,1.549634887,1.549402412,1.549169778,
     &     1.548936993,1.548704063,1.548470995,1.548237797,1.548004477,
     &     1.54777104,1.547537495,1.547303849,1.547070108,1.546836281,
     &     1.546602374,1.546368394,1.546134349,1.545900246,1.545666092/
      data rea2/1.545431894,1.54519766,1.544963397,1.544729111,1.544494811,
     &     1.544260503,1.544026194,1.543791892,1.543557604,1.543323337,
     &     1.543089099,1.542854896,1.542620736,1.542386626,1.542152573,
     &     1.541918585,1.541684668,1.54145083,1.541217077,1.540983419,
     &     1.54074986,1.540516409,1.540283073,1.540049859,1.539816774,
     &     1.539583826,1.539351021,1.539118367,1.538885871,1.538653541,
     &     1.538421383,1.538189404,1.537957613,1.537726015,1.537494619,
     &     1.537263432,1.53703246,1.536801711,1.536571192,1.53634091,
     &     1.536110873,1.535881088,1.535651561,1.535422301,1.535193314,
     &     1.534964608,1.534736189,1.534508066,1.534280244,1.534052732/
      data rea3/1.533825537,1.533598665,1.533372124,1.533145922,1.532920065,
     &     1.53269456,1.532469415,1.532244638,1.532020234,1.531796212,
     &     1.531572579,1.531349341,1.531126507,1.530904083,1.530682076,
     &     1.530460494,1.530239344,1.530018632,1.529798368,1.529578556,
     &     1.529359205,1.529140323,1.528921915,1.52870399,1.528486554,
     &     1.528269615,1.52805318,1.527837255,1.52762185,1.52740697,
     &     1.527192622,1.526978815,1.526765554,1.526552849,1.526340704,
     &     1.526129129,1.525918129,1.525707713,1.525497887,1.525288658,
     &     1.525080035,1.524872023,1.524664631,1.524457865,1.524251732,
     &     1.524046241,1.523841398,1.523637209,1.523433684,1.523230828/
      data rea4/1.523028648,1.522827153,1.522626349,1.522426244,1.522226844,
     &     1.522028158,1.521830191,1.521632951,1.521436447,1.521240683,
     &     1.521045669,1.520851411,1.520657916,1.520465192,1.520273245,
     &     1.520082084,1.519891714,1.519702144,1.519513381,1.519325431,
     &     1.519138302,1.518952002,1.518766537,1.518581914,1.518398141,
     &     1.518215226,1.518033174,1.517851994,1.517671692,1.517492277,
     &     1.517313754,1.517136132,1.516959417,1.516783616,1.516608738,
     &     1.516434788,1.516261775,1.516089706,1.515918587,1.515748426,
     &     1.51557923,1.515411006,1.515243762,1.515077504,1.514912241,
     &     1.514747978,1.514584724,1.514422485,1.514261269,1.514101083/
      data rea5/1.513941935,1.51378383,1.513626777,1.513470783,1.513315855,
     &     1.513162,1.513009225,1.512857538,1.512706946,1.512557456,
     &     1.512409075,1.51226181,1.512115669,1.511970659,1.511826787,
     &     1.51168406,1.511542485,1.511402071,1.511262823,1.511124749,
     &     1.510987856,1.510852152,1.510717643,1.510584337,1.510452242,
     &     1.510321364,1.51019171,1.510063288,1.509936104,1.509810167,
     &     1.509685483,1.50956206,1.509439905,1.509319024,1.509199426,
     &     1.509081116,1.508964104,1.508848395,1.508733997,1.508620917,
     &     1.508509163,1.508398741,1.508289659,1.508181924,1.508075544,
     &     1.507970524,1.507866873,1.507764598,1.507663706,1.507564205/
      data rea6/1.5074661,1.507369401,1.507274113,1.507180244,1.507087802,
     &     1.506996793,1.506907224,1.506819104,1.506732438,1.506647235,
     &     1.506563501,1.506481244,1.506400471,1.506321189,1.506243405,
     &     1.506167127,1.506092362,1.506019116,1.505947398,1.505877213,
     &     1.505808571,1.505741477,1.505675939,1.505611965,1.50554956,
     &     1.505488733,1.505429491,1.505371841,1.505315791,1.505261346,
     &     1.505208515,1.505157305,1.505107723,1.505059776,1.505013472,
     &     1.504968817,1.504925819,1.504884485,1.504844823,1.504806839,
     &     1.50477054,1.504735934,1.504703029,1.50467183,1.504642346,
     &     1.504614584,1.504588551,1.504564254,1.5045417,1.504520896/
      data rea7/1.504501851,1.50448457,1.504469061,1.504455332,1.504443389,
     &     1.50443324/
c     <<<<<<< acrnsg.F
    
c     =======

c     >>>>>>> 1.4
      integer i
      integer isave
      save isave, WL, REAL

c data input
      if(isave.eq.0) then
         isave=1
         do i=1,max
            WL(i) = wlstart + float(i-1)
         enddo
      endif

c begin
      if(wlen .lt. WL(1)) then
         acrnsg = 1.49
      else if(wlen .eq. WL(max)) then
         acrnsg = REAL(max)
      else if(wlen .gt. WL(max)) then
         acrnsg = 1.49
      else 
         i = 1
         do while (WL(i) .le. wlen)
            i = i + 1
         enddo
         diff = WL(i) - WL(i-1)
         acrnsg = REAL(i)*(wlen-WL(i-1))/diff + 
     &        REAL(i-1)*(WL(i)-wlen)/diff
      endif
      
      return
      end
      









