************************************************************************
*     -------------------------------------
      SUBROUTINE SKTSIG_le_sk3(PE,SIG,tune_fac)
*     -------------------------------------
*
*     (Purpose)
*        TDC resolution for SK-III LOWE
*
*     (Input)
*        PE ; Photoelectrons
*
*     (Output)
*        SIG ; TDC resolution (nsec)       
*       
*     (Creation Date and Author)
*       1992.06.17 ; First version by K.S.Hirata
*       2008.06.15 ; Modified by M.Ikeda
*
************************************************************************

      implicit none

C ARG  
      REAL PE,SIG,tune_fac

C PARAMETER
      INTEGER   MAXT
      PARAMETER(MAXT=132)

C VAR    
      INTEGER I
      REAL    RATIO
      real PENUM(MAXT), TRES(MAXT)
      real tune , tmp
      parameter(tune = 1.185)
c     <<<<<<< sktsig_le.F

      real p1(50),p2(50),p3(32)
      real t1(50),t2(50),t3(32)
 
      equivalence(PENUM(1),p1(1))
      equivalence(PENUM(51),p2(1))
      equivalence(PENUM(101),p3(1))
      
      equivalence(TRES(1),t1(1))
      equivalence(TRES(51),t2(1))
      equivalence(TRES(101),t3(1))

c     =======
      equivalence(PENUM(1),p1(1))
      equivalence(PENUM(51),p2(1))
      equivalence(PENUM(101),p3(1))
      equivalence(TRES(1),t1(1))
      equivalence(TRES(51),t2(1))
      equivalence(TRES(101),t3(1))

c     >>>>>>>1.4

      data p1 / 0.17833, 0.26750, 0.35667, 0.44583, 0.53500, 0.62416, 0.71333,
     &     0.80250, 0.89166, 0.98083, 1.07000, 1.15916, 1.24833, 1.33749, 
     &     1.42666, 1.51583, 1.60499, 1.69416, 1.78333, 1.87249, 1.96166, 
     &     2.05082, 2.13999, 2.22916, 2.31832, 2.40749, 2.49666, 2.58582, 
     &     2.67499, 2.76415, 2.85332, 2.94249, 3.03165, 3.12082, 3.20999, 
     &     3.29915, 3.38832, 3.47748, 3.56665, 3.65582, 3.74498, 3.83415, 
     &     3.92332, 4.01248, 4.10165, 4.19081, 4.27998, 4.36915, 4.45831, 4.66843 /

      data p2 / 4.88844, 5.11883, 5.36007, 5.61269, 5.87720, 6.15419, 
     &     6.44422, 6.74793, 7.06595, 7.39896, 7.74766, 8.11280, 8.49514, 
     &     8.89551, 9.31474, 9.75373, 10.21341, 10.69475, 11.19878, 11.72656, 
     &     12.27922, 12.85792, 13.46390, 14.09843, 14.76287, 15.45862, 16.18716, 
     &     16.95004, 17.74887, 18.58535, 19.46125, 20.37843, 21.33883, 22.34451, 
     &     23.39757, 24.50026, 25.65492, 26.86400, 28.13006, 29.45580, 30.84401, 
     &     32.29763, 33.81977, 35.41365, 37.08264, 38.83030, 40.66032, 42.57658, 
     &     44.58315, 46.68428 /

      data p3 / 48.88445, 51.18829, 53.60072, 56.12685, 58.77202, 
     &     61.54189, 64.44227, 67.47934, 70.65953, 73.98961,  77.47663,  81.12799, 
     &     84.95143, 88.95506, 93.14738, 97.53728, 102.13406, 106.94756,
     &     111.98783, 117.26565, 122.79220, 128.57921, 134.63895, 140.98428, 
     &     147.62866, 154.58618, 161.87160, 169.50037, 177.48866, 185.85344, 
     &     194.61253, 203.78435 / 

      data t1 / 3.80900,  3.68246,  3.59636,  3.359644, 3.216274, 2.95878, 
     &     2.777422, 2.560836, 2.374482, 2.241148, 2.226412, 2.166738, 
     &     2.16579,  2.132014, 2.127198, 2.10308,  2.106764, 2.087152, 2.06542,
     &     2.029968, 1.999484, 1.961196, 1.92574,  1.914986, 1.905596, 1.878234, 
     &     1.870546, 1.851374, 1.824108, 1.793532, 1.780498, 1.733372, 1.703298, 
     &     1.687818, 1.651902, 1.624316, 1.587974, 1.573496, 1.572208, 1.56046, 
     &     1.584,    1.58147,  1.533524, 1.496364, 1.505,    1.441336, 1.440074, 
     &     1.44521,  1.409714 ,1.369598/

      data t2 /  1.347466, 1.329752, 1.32255,  1.302618, 
     &     1.29983,  1.293776, 1.274318, 1.236962, 1.236538, 1.192324, 1.156786, 
     &     1.124934, 1.107364, 1.088272, 1.082872, 1.08095,  1.07799,  1.068706, 
     &     1.050518, 1.035046, 1.009534, 0.977256, 0.965748, 0.94476,  0.925892, 
     &     0.913764, 0.9074,   0.89935,  0.88718,  0.885558, 0.877226, 0.859086, 
     &     0.844056, 0.827532, 0.81019,  0.798658, 0.779778, 0.768092, 0.7625, 
     &     0.75422,  0.748664, 0.74424,  0.727272, 0.698156, 0.681556, 0.6649, 
     &     0.664546, 0.661064, 0.673368, 0.665246 /

      data t3 / 0.657202, 0.647954, 0.632378, 
     &     0.614064, 0.599434, 0.592006, 0.577414, 0.579522, 0.586352, 0.59113, 
     &     0.594098, 0.616358, 0.63419,  0.641908, 0.646394, 0.639622, 0.614194, 
     &     0.59066,  0.574478, 0.563994, 0.56014,  0.55449,  0.55612,  0.544966, 
     &     0.541226, 0.5397,   0.54595,  0.548718, 0.573184, 0.582702, 
     &     0.5926725, 0.60498 /


      save PENUM,p1,p2,p3,TRES,t1,t2,t3

C program     

      IF(PE.LE.PENUM(1))THEN
         SIG = TRES(1)
      ELSE IF(PE.GE.PENUM(MAXT))THEN
         SIG = TRES(MAXT)
      ELSE
         I = 1
 10      CONTINUE
            I = I + 1
         IF(PE.GT.PENUM(I))GOTO 10
         RATIO = (PE-PENUM(I-1))/(PENUM(I)-PENUM(I-1))
         SIG = TRES(I-1)+RATIO*(TRES(I)-TRES(I-1))
      ENDIF
      SIG = SIG*tune
      RETURN
      END
